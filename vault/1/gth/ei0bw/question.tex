


\usetikzlibrary{shapes} 

\ifnumequal{\value{rolldice}}{0}{
  % variables 
  \renewcommand{\vbone}{34}
  \renewcommand{\vbtwo}{2}
  \renewcommand{\vbthree}{15}
  \renewcommand{\vbfour}{8}
  \renewcommand{\vbfive}{28}
}{
  \ifnumequal{\value{rolldice}}{1}{
    % variables 
    \renewcommand{\vbone}{40}
    \renewcommand{\vbtwo}{1}
    \renewcommand{\vbthree}{12}
    \renewcommand{\vbfour}{9}
    \renewcommand{\vbfive}{31}
  }{
    \ifnumequal{\value{rolldice}}{2}{
      % variables 
      \renewcommand{\vbone}{36}
      \renewcommand{\vbtwo}{2}
      \renewcommand{\vbthree}{13}
      \renewcommand{\vbfour}{8}
      \renewcommand{\vbfive}{29}
    }{
      % variables 
      \renewcommand{\vbone}{37}
      \renewcommand{\vbtwo}{1}
      \renewcommand{\vbthree}{16}
      \renewcommand{\vbfour}{9}
      \renewcommand{\vbfive}{32}
    }
  }
}

\question The figure below shows a $B^{+}$ tree of degree $d=2$.
For simplicity, pointers in the leaf nodes are not shown. But remember that leaf 
nodes form a linked list. In the questions that follow, be mindful of overflow and underflow 
and maintain a fill-factor/occupancy of $\geq 50\%$. Root node can have $k$ keys where $1 \leq k \leq 2d$.


\watchout

  % stuff to be shown only in the answer key - like explanatory margin figures
  \begin{tikzpicture}[>= stealth, ->, level distance=10mm]
    \tikzstyle{bplus}=[rectangle split, rectangle split horizontal, draw]
    \tikzstyle{every node}=[bplus]
    \tikzstyle{level 1}=[sibling distance=30mm]
    \node[label=90:$A$]{7\nodepart{two} 25\nodepart{three} 35}
      child {node[label=270:$B$] {3 \nodepart{two} 4\nodepart{three} 5\nodepart{four} 6}}
      child {node[label=270:$C$] {\vbfour\nodepart{two} 10\nodepart{three} 17\nodepart{four} 19}}
      child {node[label=270:$D$] {\vbfive\nodepart{two} 33}}
      child {node[label=270:$E$] {42 \nodepart{two} 51}} ;
  \end{tikzpicture}

\begin{parts}
  \part What will the $B^{+}$ tree look like after inserting $\mathbf{\vbone, \vbtwo}$ and $\mathbf\vbthree$ - in that order?

  \begin{solution}
    \begin{align}
      &D+\vbone\longrightarrow\text{ no problem } \\
      &\underbrace{B+\vbtwo}_{\texttt{overflow}} \longrightarrow \underbrace{(B_1, B_2)}_{\texttt{split}} 
      + \underbrace{(A+4)}_{\texttt{4 added to A}} \\
      &\underbrace{C + \vbthree}_{\texttt{overflow}}\longrightarrow
      \underbrace{(C_1, C_2)}_{\texttt{split}} + \underbrace{(A+\vbthree)}_{\texttt{overflow}}\longrightarrow
      \underbrace{(C_1, C_2)}_{\texttt{split}} + \underbrace{A\longrightarrow(A_1, A_2, A_3)}_{\texttt{split}}
    \end{align}
  \end{solution}
  \begin{tikzpicture}[>= stealth, ->, level distance=10mm]
    \tikzstyle{bplus}=[rectangle split, rectangle split horizontal, rectangle split ignore empty parts, draw]
    \tikzstyle{every node}=[bplus]
    \tikzstyle{level 1}=[sibling distance=70mm]
    \tikzstyle{level 2}=[sibling distance=20mm]
    \node[label=90:$A_1$]{\vbthree}
      child {node[label=180:$A_2$] {4\nodepart{two} 7}
        child {node[label=270:$B_1$] {\vbtwo\nodepart{two} 3}}
        child {node[label=270:$B_2$] {5\nodepart{two} 6}}
        child {node[label=270:$C_1$] {\vbfour\nodepart{two} 10}}
      }
      child {node[label=180:$A_3$] {25\nodepart{two} 35}
        child {node[label=270:$C_2$] {17\nodepart{two} 19}}
        child {node[label=270:$D$] {\vbfive\nodepart{two} 33\nodepart{three} \vbone}}
        child {node[label=270:$E$] {42 \nodepart{two} 51}}
      };
  \end{tikzpicture}

  \part If $\mathbf{\vbfive}$ and $\mathbf{\vbfour}$ are now removed from the tree - in that order - 
  \textbf{after} the insertions done in part (a), then what will the $B^{+}$ tree look like?

  \begin{solution}
    \begin{align}
      &D-\vbfive\longrightarrow\text{ no problem } \\
      &\underbrace{C_1-\vbfour}_{\texttt{underflow}}\longrightarrow(B_2+C_1) + \text{ move 7 to }A_2 \text{ and copy 4 to }B_2
    \end{align}
  \end{solution}
  \begin{tikzpicture}[>= stealth, ->, level distance=10mm]
    \tikzstyle{bplus}=[rectangle split, rectangle split horizontal, rectangle split ignore empty parts, draw]
    \tikzstyle{every node}=[bplus]
    \tikzstyle{level 1}=[sibling distance=70mm]
    \tikzstyle{level 2}=[sibling distance=20mm]
    \node[label=90:$A_1$]{\vbthree}
      child {node[label=180:$A_2$] {4\nodepart{two} 6}
        child {node[label=270:$B_1$] {\vbtwo\nodepart{two} 3}}
        child {node[label=270:$B_2$] {4\nodepart{two} 5}}
        child {node[label=270:$C_1$] {7\nodepart{two} 10}}
      }
      child {node[label=180:$A_3$] {25\nodepart{two} 35}
        child {node[label=270:$C_2$] {17\nodepart{two} 19}}
        child {node[label=270:$D$] {33\nodepart{two} \vbone}}
        child {node[label=270:$E$] {42 \nodepart{two} 51}}
      };
  \end{tikzpicture}

\end{parts}

